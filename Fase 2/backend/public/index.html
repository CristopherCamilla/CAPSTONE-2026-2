<!doctype html>
<html>
<head>
    <meta charset="utf-8" />
    <title>API Aristo – Índice</title>
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <style>
        body{font-family:system-ui,Segoe UI,Roboto,Arial;margin:2rem;line-height:1.45}
        h1{margin:0 0 .5rem}
        .note{color:#666;margin:.5rem 0 1rem}
        ul{padding-left:1.2rem}
        small{color:#888}
        code{background:#f5f5f5;padding:2px 4px;border-radius:4px}
        a{ text-decoration:none }
        a:hover{ text-decoration:underline }
    </style>
</head>
<body>
<h1>API Aristo</h1>
<div class="note">Servidor OK. Enlaces útiles:</div>
<ul id="fixed">
    <li><a href="/health">/health</a> <small>GET</small></li>
</ul>
<h2>Endpoints detectados</h2>
<ul id="routes"><li>Cargando…</li></ul>

<script type="module">
    async function load() {
        try {
            const res = await fetch("/__routes");
            const data = await res.json();
            const ul = document.getElementById("routes");
            ul.innerHTML = "";
            (data.endpoints ?? []).forEach(r => {
                const li = document.createElement("li");
                const a = document.createElement("a");
                a.href = r.url;
                a.textContent = r.url;
                const meta = document.createElement("small");
                meta.textContent = " " + r.method;
                li.appendChild(a);
                li.appendChild(meta);
                ul.appendChild(li);
            });
            if (!ul.children.length) ul.innerHTML = "<li><em>No hay rutas GET registradas.</em></li>";
        } catch (e) {
            document.getElementById("routes").innerHTML = "<li><em>Error cargando rutas</em></li>";
            console.error(e);
        }
    }
    load();
</script>
</body>
</html>